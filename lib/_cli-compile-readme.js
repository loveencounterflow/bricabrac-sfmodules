(function() {
  'use strict';
  var FS, PATH, append, base_path, clear, debug, file_has_uncommitted_changes, join, line, log, main_path, resolve, rpr, spawnSync, src_path, target_path, walk_lines_with_positions, warn, x;

  //===========================================================================================================
  FS = require('node:fs');

  PATH = require('node:path');

  ({resolve, join} = PATH);

  // { matchesGlob,          } = require
  ({walk_lines_with_positions} = (require('./unstable-fast-linereader-brics')).require_fast_linereader());

  ({warn, log, debug} = console);

  ({rpr} = (require('./loupe-brics')).require_loupe());

  ({spawnSync} = require('node:child_process'));

  /*
  base_path = PATH.resolve PATH.join __dirname, '..'
  pattern   = '*.md'
  entries   = FS.readdirSync base_path, { recursive: true, }
  entries.sort()
  for entry in entries
    continue unless ( FS.statSync entry ).isFile()
    continue unless PATH.matchesGlob entry, pattern
    debug 'Ωcrmmd___1', entry
  */
  //-----------------------------------------------------------------------------------------------------------
  file_has_uncommitted_changes = function(path) {
    var status;
    ({status} = spawnSync('git', ['diff', '--quiet', path], {
      cwd: base_path
    }));
    if (status === 0) {
      return false;
    }
    return true;
  };

  //-----------------------------------------------------------------------------------------------------------
  clear = function(path) {
    FS.writeFileSync(path, '');
    return null;
  };

  //-----------------------------------------------------------------------------------------------------------
  append = function(path, text) {
    FS.appendFileSync(path, `${text}\n`);
    return null;
  };

  //===========================================================================================================
  base_path = resolve(join(__dirname, '..'));

  src_path = resolve(join(base_path, 'doc-src'));

  main_path = resolve(src_path, 'main.md');

  target_path = resolve(base_path, 'README.md');

  //===========================================================================================================
  debug('Ωcrmmd___3', {base_path, src_path, main_path});

  //===========================================================================================================
  if (file_has_uncommitted_changes(target_path)) {
    warn();
    warn("target file");
    warn(`  ${target_path}`);
    warn("has uncomitted changes; terminating");
    warn();
    process.exit(111);
  }

  //===========================================================================================================
  clear(target_path);

  for (x of walk_lines_with_positions(main_path)) {
    ({line} = x);
    // debug 'Ωcrmmd___4', rpr line
    append(target_path, line);
  }

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL19jbGktY29tcGlsZS1yZWFkbWUuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBO0VBQUE7QUFBQSxNQUFBLEVBQUEsRUFBQSxJQUFBLEVBQUEsTUFBQSxFQUFBLFNBQUEsRUFBQSxLQUFBLEVBQUEsS0FBQSxFQUFBLDRCQUFBLEVBQUEsSUFBQSxFQUFBLElBQUEsRUFBQSxHQUFBLEVBQUEsU0FBQSxFQUFBLE9BQUEsRUFBQSxHQUFBLEVBQUEsU0FBQSxFQUFBLFFBQUEsRUFBQSxXQUFBLEVBQUEseUJBQUEsRUFBQSxJQUFBLEVBQUEsQ0FBQTs7O0VBR0EsRUFBQSxHQUE0QixPQUFBLENBQVEsU0FBUjs7RUFDNUIsSUFBQSxHQUE0QixPQUFBLENBQVEsV0FBUjs7RUFDNUIsQ0FBQSxDQUFFLE9BQUYsRUFDRSxJQURGLENBQUEsR0FDNEIsSUFENUIsRUFMQTs7O0VBUUEsQ0FBQSxDQUFFLHlCQUFGLENBQUEsR0FDNEIsQ0FBRSxPQUFBLENBQVEsa0NBQVIsQ0FBRixDQUE4QyxDQUFDLHVCQUEvQyxDQUFBLENBRDVCOztFQUVBLENBQUEsQ0FBRSxJQUFGLEVBQ0UsR0FERixFQUVFLEtBRkYsQ0FBQSxHQUU0QixPQUY1Qjs7RUFHQSxDQUFBLENBQUUsR0FBRixDQUFBLEdBQTRCLENBQUUsT0FBQSxDQUFRLGVBQVIsQ0FBRixDQUEyQixDQUFDLGFBQTVCLENBQUEsQ0FBNUI7O0VBQ0EsQ0FBQSxDQUFFLFNBQUYsQ0FBQSxHQUE0QixPQUFBLENBQVEsb0JBQVIsQ0FBNUIsRUFkQTs7Ozs7Ozs7Ozs7OztFQTZCQSw0QkFBQSxHQUErQixRQUFBLENBQUUsSUFBRixDQUFBO0FBQy9CLFFBQUE7SUFBRSxDQUFBLENBQUUsTUFBRixDQUFBLEdBQWMsU0FBQSxDQUFVLEtBQVYsRUFBaUIsQ0FBRSxNQUFGLEVBQVUsU0FBVixFQUFxQixJQUFyQixDQUFqQixFQUErQztNQUFFLEdBQUEsRUFBSztJQUFQLENBQS9DLENBQWQ7SUFDQSxJQUFnQixNQUFBLEtBQVUsQ0FBMUI7QUFBQSxhQUFPLE1BQVA7O0FBQ0EsV0FBTztFQUhzQixFQTdCL0I7OztFQW1DQSxLQUFBLEdBQVEsUUFBQSxDQUFFLElBQUYsQ0FBQTtJQUNOLEVBQUUsQ0FBQyxhQUFILENBQWlCLElBQWpCLEVBQXVCLEVBQXZCO0FBQ0EsV0FBTztFQUZELEVBbkNSOzs7RUF3Q0EsTUFBQSxHQUFTLFFBQUEsQ0FBRSxJQUFGLEVBQVEsSUFBUixDQUFBO0lBQ1AsRUFBRSxDQUFDLGNBQUgsQ0FBa0IsSUFBbEIsRUFBd0IsQ0FBQSxDQUFBLENBQUcsSUFBSCxDQUFBLEVBQUEsQ0FBeEI7QUFDQSxXQUFPO0VBRkEsRUF4Q1Q7OztFQTZDQSxTQUFBLEdBQWMsT0FBQSxDQUFRLElBQUEsQ0FBSyxTQUFMLEVBQWdCLElBQWhCLENBQVI7O0VBQ2QsUUFBQSxHQUFjLE9BQUEsQ0FBUSxJQUFBLENBQUssU0FBTCxFQUFnQixTQUFoQixDQUFSOztFQUNkLFNBQUEsR0FBYyxPQUFBLENBQVEsUUFBUixFQUFrQixTQUFsQjs7RUFDZCxXQUFBLEdBQWMsT0FBQSxDQUFRLFNBQVIsRUFBbUIsV0FBbkIsRUFoRGQ7OztFQW1EQSxLQUFBLENBQU0sWUFBTixFQUFvQixDQUFFLFNBQUYsRUFBYSxRQUFiLEVBQXVCLFNBQXZCLENBQXBCLEVBbkRBOzs7RUFzREEsSUFBRyw0QkFBQSxDQUE2QixXQUE3QixDQUFIO0lBQ0UsSUFBQSxDQUFBO0lBQ0EsSUFBQSxDQUFLLGFBQUw7SUFDQSxJQUFBLENBQUssR0FBQSxDQUFBLENBQUssV0FBTCxDQUFBLENBQUw7SUFDQSxJQUFBLENBQUsscUNBQUw7SUFDQSxJQUFBLENBQUE7SUFDQSxPQUFPLENBQUMsSUFBUixDQUFhLEdBQWIsRUFORjtHQXREQTs7O0VBK0RBLEtBQUEsQ0FBTSxXQUFOOztFQUNBLEtBQUEseUNBQUE7S0FBSSxDQUFFLElBQUYsT0FDSjs7SUFDRSxNQUFBLENBQU8sV0FBUCxFQUFvQixJQUFwQjtFQUZGO0FBaEVBIiwic291cmNlc0NvbnRlbnQiOlsiXG4ndXNlIHN0cmljdCdcblxuIz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5GUyAgICAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZSAnbm9kZTpmcydcblBBVEggICAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlICdub2RlOnBhdGgnXG57IHJlc29sdmUsXG4gIGpvaW4sICAgICAgICAgICAgICAgICB9ID0gUEFUSFxuIyB7IG1hdGNoZXNHbG9iLCAgICAgICAgICB9ID0gcmVxdWlyZVxueyB3YWxrX2xpbmVzX3dpdGhfcG9zaXRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSA9ICggcmVxdWlyZSAnLi91bnN0YWJsZS1mYXN0LWxpbmVyZWFkZXItYnJpY3MnICkucmVxdWlyZV9mYXN0X2xpbmVyZWFkZXIoKVxueyB3YXJuLFxuICBsb2csXG4gIGRlYnVnLCAgICAgICAgICAgICAgICB9ID0gY29uc29sZVxueyBycHIsICAgICAgICAgICAgICAgICAgfSA9ICggcmVxdWlyZSAnLi9sb3VwZS1icmljcycgKS5yZXF1aXJlX2xvdXBlKClcbnsgc3Bhd25TeW5jLCAgICAgICAgICAgIH0gPSByZXF1aXJlICdub2RlOmNoaWxkX3Byb2Nlc3MnXG5cblxuIyMjXG5iYXNlX3BhdGggPSBQQVRILnJlc29sdmUgUEFUSC5qb2luIF9fZGlybmFtZSwgJy4uJ1xucGF0dGVybiAgID0gJyoubWQnXG5lbnRyaWVzICAgPSBGUy5yZWFkZGlyU3luYyBiYXNlX3BhdGgsIHsgcmVjdXJzaXZlOiB0cnVlLCB9XG5lbnRyaWVzLnNvcnQoKVxuZm9yIGVudHJ5IGluIGVudHJpZXNcbiAgY29udGludWUgdW5sZXNzICggRlMuc3RhdFN5bmMgZW50cnkgKS5pc0ZpbGUoKVxuICBjb250aW51ZSB1bmxlc3MgUEFUSC5tYXRjaGVzR2xvYiBlbnRyeSwgcGF0dGVyblxuICBkZWJ1ZyAnzqljcm1tZF9fXzEnLCBlbnRyeVxuIyMjXG5cbiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuZmlsZV9oYXNfdW5jb21taXR0ZWRfY2hhbmdlcyA9ICggcGF0aCApIC0+XG4gIHsgc3RhdHVzLCB9ID0gc3Bhd25TeW5jICdnaXQnLCBbICdkaWZmJywgJy0tcXVpZXQnLCBwYXRoLCBdLCB7IGN3ZDogYmFzZV9wYXRoLCB9XG4gIHJldHVybiBmYWxzZSBpZiBzdGF0dXMgaXMgMFxuICByZXR1cm4gdHJ1ZVxuXG4jLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmNsZWFyID0gKCBwYXRoICkgLT5cbiAgRlMud3JpdGVGaWxlU3luYyBwYXRoLCAnJ1xuICByZXR1cm4gbnVsbFxuXG4jLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmFwcGVuZCA9ICggcGF0aCwgdGV4dCApIC0+XG4gIEZTLmFwcGVuZEZpbGVTeW5jIHBhdGgsIFwiI3t0ZXh0fVxcblwiXG4gIHJldHVybiBudWxsXG5cbiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuYmFzZV9wYXRoICAgPSByZXNvbHZlIGpvaW4gX19kaXJuYW1lLCAnLi4nXG5zcmNfcGF0aCAgICA9IHJlc29sdmUgam9pbiBiYXNlX3BhdGgsICdkb2Mtc3JjJ1xubWFpbl9wYXRoICAgPSByZXNvbHZlIHNyY19wYXRoLCAnbWFpbi5tZCdcbnRhcmdldF9wYXRoID0gcmVzb2x2ZSBiYXNlX3BhdGgsICdSRUFETUUubWQnXG5cbiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuZGVidWcgJ86pY3JtbWRfX18zJywgeyBiYXNlX3BhdGgsIHNyY19wYXRoLCBtYWluX3BhdGgsIH1cblxuIz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5pZiBmaWxlX2hhc191bmNvbW1pdHRlZF9jaGFuZ2VzIHRhcmdldF9wYXRoXG4gIHdhcm4oKVxuICB3YXJuIFwidGFyZ2V0IGZpbGVcIlxuICB3YXJuIFwiICAje3RhcmdldF9wYXRofVwiXG4gIHdhcm4gXCJoYXMgdW5jb21pdHRlZCBjaGFuZ2VzOyB0ZXJtaW5hdGluZ1wiXG4gIHdhcm4oKVxuICBwcm9jZXNzLmV4aXQgMTExXG5cbiM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuY2xlYXIgdGFyZ2V0X3BhdGhcbmZvciB7IGxpbmUsIH0gZnJvbSB3YWxrX2xpbmVzX3dpdGhfcG9zaXRpb25zIG1haW5fcGF0aFxuICAjIGRlYnVnICfOqWNybW1kX19fNCcsIHJwciBsaW5lXG4gIGFwcGVuZCB0YXJnZXRfcGF0aCwgbGluZVxuXG5cblxuXG5cblxuIl19
